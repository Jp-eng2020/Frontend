/**
 * @fileoverview added by tsickle
 * Generated from: lib/slider-custom-image/slider-custom-image.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Inject, Output, EventEmitter } from '@angular/core';
import { DOCUMENT } from '@angular/common';
import { DomSanitizer } from '@angular/platform-browser';
import { NgImageSliderService } from './../ng-image-slider.service';
import { SliderService } from '../services/slider.service';
/** @type {?} */
const youtubeRegExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=|\?v=)([^#\&\?]*).*/;
/** @type {?} */
const validFileExtensions = ['jpeg', 'jpg', 'gif', 'png'];
/** @type {?} */
const validVideoExtensions = ['mp4'];
/** @type {?} */
const vimeoRegExp = /\/\/(?:www.)?vimeo.com\/([0-9a-z-_]+)/i;
export class SliderCustomImageComponent {
    /**
     * @param {?} imageSliderService
     * @param {?} sanitizer
     * @param {?} document
     * @param {?} sliderService
     */
    constructor(imageSliderService, sanitizer, document, sliderService) {
        this.imageSliderService = imageSliderService;
        this.sanitizer = sanitizer;
        this.sliderService = sliderService;
        this.YOUTUBE = 'youtube';
        this.IMAGE = 'image';
        this.VIDEO = 'video';
        this.ANOTHER_VIDEO = 'another-video';
        this.fileUrl = '';
        this.videoUrl = '';
        this.fileExtension = '';
        this.type = this.IMAGE;
        this.imageLoading = true;
        // @inputs
        this.showVideo = false;
        this.videoAutoPlay = false;
        this.showVideoControls = 1;
        this.speed = 1;
        this.isVideo = false;
        this.alt = '';
        this.title = '';
        this.direction = 'ltr';
        this.ratio = false;
        this.lazy = false;
        this.getThumbnail = new EventEmitter();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (this.imageUrl
            && this.imageUrl
            && this.imageUrl
            && typeof (this.imageUrl) === 'string'
            && ((changes.imageUrl && changes.imageUrl.firstChange)
                ||
                    (this.videoAutoPlay))) {
            this.setUrl();
        }
    }
    /**
     * @return {?}
     */
    setUrl() {
        /** @type {?} */
        const url = this.imageUrl;
        this.imageLoading = true;
        this.fileUrl = this.sanitizer.bypassSecurityTrustResourceUrl(url);
        this.fileExtension = url.split('.').pop().split(/\#|\?/)[0];
        if (this.imageSliderService.base64FileExtension(url)
            && (validFileExtensions.indexOf(this.imageSliderService.base64FileExtension(url).toLowerCase()) > -1
                || validVideoExtensions.indexOf(this.imageSliderService.base64FileExtension(url).toLowerCase()) > -1)) {
            this.fileExtension = this.imageSliderService.base64FileExtension(url);
        }
        // verify for youtube url
        /** @type {?} */
        const match = url.match(youtubeRegExp);
        /** @type {?} */
        const matchVimeoUrl = url.match(vimeoRegExp);
        if (match && match[2].length === 11) {
            if (this.showVideo) {
                this.type = this.YOUTUBE;
                this.fileUrl = this.sanitizer.bypassSecurityTrustResourceUrl(`${'https://www.youtube.com/embed/'}${match[2]}${this.videoAutoPlay ? '?autoplay=1&enablejsapi=1' : '?autoplay=0&enablejsapi=1'}${'&controls='}${this.showVideoControls}`);
            }
            else {
                this.type = this.IMAGE;
                this.fileUrl = this.sanitizer.bypassSecurityTrustResourceUrl(`https://img.youtube.com/vi/${match[2]}/0.jpg`);
                /** @type {?} */
                let thumnailObject = { index: this.imagePositionInSlider, image: this.fileUrl };
                this.getThumbnail.emit(thumnailObject);
            }
        }
        else if (matchVimeoUrl) {
            this.sliderService.getoEmbedResponse('https://vimeo.com/api/oembed.json?url=', url).subscribe((/**
             * @param {?} res
             * @return {?}
             */
            res => {
                if (this.showVideo) {
                    this.type = this.ANOTHER_VIDEO;
                    /** @type {?} */
                    let vimeoVideoUrl = `${'https://player.vimeo.com/video/'}${res['video_id']}`;
                    this.videoUrl = this.sanitizer.bypassSecurityTrustResourceUrl(vimeoVideoUrl);
                }
                else {
                    this.type = this.IMAGE;
                    this.videoUrl = this.sanitizer.bypassSecurityTrustResourceUrl(res['thumbnail_url']);
                    /** @type {?} */
                    let thumnailObject = { index: this.imagePositionInSlider, image: this.videoUrl };
                    this.getThumbnail.emit(thumnailObject);
                }
            }));
        }
        else if (url.indexOf('https://player.vimeo.com/video') !== -1) {
            if (this.showVideo) {
                this.type = this.ANOTHER_VIDEO;
                this.videoUrl = this.sanitizer.bypassSecurityTrustResourceUrl(url);
            }
            else {
                this.type = this.IMAGE;
                this.videoUrl = this.sanitizer.bypassSecurityTrustResourceUrl('data:image/png;base64,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');
                /** @type {?} */
                let thumnailObject = { index: this.imagePositionInSlider, image: this.videoUrl };
                this.getThumbnail.emit(thumnailObject);
            }
        }
        else if (url.indexOf('https://players.brightcove.net/') !== -1) {
            if (this.showVideo) {
                this.type = this.ANOTHER_VIDEO;
                this.videoUrl = this.sanitizer.bypassSecurityTrustResourceUrl(url);
            }
            else {
                this.type = this.IMAGE;
                this.videoUrl = this.sanitizer.bypassSecurityTrustResourceUrl('https://cdn.mos.cms.futurecdn.net/xnhBGrzwAHmbTmyfWx6RsM-970-75.png.webp');
                /** @type {?} */
                let thumnailObject = { index: this.imagePositionInSlider, image: this.videoUrl };
                this.getThumbnail.emit(thumnailObject);
            }
        }
        else if (this.fileExtension && validFileExtensions.indexOf(this.fileExtension.toLowerCase()) > -1) {
            this.type = this.IMAGE;
        }
        else if (this.fileExtension && validVideoExtensions.indexOf(this.fileExtension.toLowerCase()) > -1) {
            this.type = this.VIDEO;
            if (this.videoAutoPlay && document.getElementById(`video_${this.imageIndex}`)) {
                /** @type {?} */
                const videoObj = document.getElementById(`video_${this.imageIndex}`);
                setTimeout((/**
                 * @return {?}
                 */
                () => {
                    videoObj.play();
                }), this.speed * 1000);
            }
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    videoClickHandler(event) {
        if (event && event.srcElement && !this.showVideoControls) {
            if (event.srcElement.paused) {
                event.srcElement.play();
            }
            else {
                event.srcElement.pause();
            }
        }
    }
}
SliderCustomImageComponent.decorators = [
    { type: Component, args: [{
                selector: 'custom-img',
                template: "\n    <div *ngIf=\"fileUrl\" class=\"custom-image-main\" [ngClass]=\"{'ng-fullimage-loading': imageLoading}\">\n        <img class=\"image cursor-pointer\"\n            (load)=\"imageLoading = false\"\n            [ngClass]=\"type === IMAGE && (imgData?.imageTitle || imgData?.imageDescription) ? {imageTitleClass: 'imageTitleClass','ratio': ratio} : {videoClass: 'videoClass','ratio': ratio}\"\n            *ngIf=\"(type === IMAGE && fileUrl) || (type === IMAGE && videoUrl)\"\n            [src]=\"videoUrl ? videoUrl : fileUrl\"\n            [alt]=\"alt\"\n            [title]=\"title\"\n            [ngStyle]=\"{'height': imgHeight}\"\n            [attr.loading]=\"lazy == true ? 'lazy' : null\">\n        <iframe class=\"youtube\"\n            *ngIf=\"(type === YOUTUBE && fileUrl) || (type === ANOTHER_VIDEO && videoUrl)\"\n            [src]=\"(type === YOUTUBE) ? fileUrl : videoUrl\"\n            [attr.loading]=\"lazy == true ? 'lazy' : null\"\n            frameborder=\"0\"\n            allow=\"autoplay\"\n            allowfullscreen></iframe>\n        <video class=\"video\"\n            [id]=\"'video_' + imageIndex\"\n            [ngClass]=\"{'ratio': ratio}\"\n            (click)=\"videoClickHandler($event)\"\n            [autoplay]=\"videoAutoPlay\"\n            *ngIf=\"type === VIDEO\"\n            type=\"video/mp4\"\n            [attr.controls]=\"showVideoControls ? showVideoControls : null\"\n            controlsList=\"nodownload\">\n            <source [src]=\"fileUrl\" type=\"video/mp4\">\n            Your browser does not support the video tag.\n        </video>\n        <div [dir]=\"direction\" *ngIf=\"!fileUrl\" class=\"invalid-msg\">Invalid file format</div>\n        <span *ngIf=\"type === YOUTUBE || type === VIDEO || isVideo\" class=\"youtube-icon cursor-pointer\" [ngStyle]=\"{'height': imgHeight}\"></span>\n    </div>"
            }] }
];
/** @nocollapse */
SliderCustomImageComponent.ctorParameters = () => [
    { type: NgImageSliderService },
    { type: DomSanitizer },
    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] },
    { type: SliderService }
];
SliderCustomImageComponent.propDecorators = {
    showVideo: [{ type: Input }],
    videoAutoPlay: [{ type: Input }],
    showVideoControls: [{ type: Input }],
    currentImageIndex: [{ type: Input }],
    imageIndex: [{ type: Input }],
    speed: [{ type: Input }],
    imageUrl: [{ type: Input }],
    isVideo: [{ type: Input }],
    alt: [{ type: Input }],
    title: [{ type: Input }],
    direction: [{ type: Input }],
    ratio: [{ type: Input }],
    lazy: [{ type: Input }],
    imgData: [{ type: Input }],
    imgHeight: [{ type: Input }],
    getThumbnail: [{ type: Output }],
    imagePositionInSlider: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    SliderCustomImageComponent.prototype.YOUTUBE;
    /** @type {?} */
    SliderCustomImageComponent.prototype.IMAGE;
    /** @type {?} */
    SliderCustomImageComponent.prototype.VIDEO;
    /** @type {?} */
    SliderCustomImageComponent.prototype.ANOTHER_VIDEO;
    /** @type {?} */
    SliderCustomImageComponent.prototype.fileUrl;
    /** @type {?} */
    SliderCustomImageComponent.prototype.videoUrl;
    /** @type {?} */
    SliderCustomImageComponent.prototype.fileExtension;
    /** @type {?} */
    SliderCustomImageComponent.prototype.type;
    /** @type {?} */
    SliderCustomImageComponent.prototype.imageLoading;
    /** @type {?} */
    SliderCustomImageComponent.prototype.showVideo;
    /** @type {?} */
    SliderCustomImageComponent.prototype.videoAutoPlay;
    /** @type {?} */
    SliderCustomImageComponent.prototype.showVideoControls;
    /** @type {?} */
    SliderCustomImageComponent.prototype.currentImageIndex;
    /** @type {?} */
    SliderCustomImageComponent.prototype.imageIndex;
    /** @type {?} */
    SliderCustomImageComponent.prototype.speed;
    /** @type {?} */
    SliderCustomImageComponent.prototype.imageUrl;
    /** @type {?} */
    SliderCustomImageComponent.prototype.isVideo;
    /** @type {?} */
    SliderCustomImageComponent.prototype.alt;
    /** @type {?} */
    SliderCustomImageComponent.prototype.title;
    /** @type {?} */
    SliderCustomImageComponent.prototype.direction;
    /** @type {?} */
    SliderCustomImageComponent.prototype.ratio;
    /** @type {?} */
    SliderCustomImageComponent.prototype.lazy;
    /** @type {?} */
    SliderCustomImageComponent.prototype.imgData;
    /** @type {?} */
    SliderCustomImageComponent.prototype.imgHeight;
    /** @type {?} */
    SliderCustomImageComponent.prototype.getThumbnail;
    /** @type {?} */
    SliderCustomImageComponent.prototype.imagePositionInSlider;
    /** @type {?} */
    SliderCustomImageComponent.prototype.imageSliderService;
    /**
     * @type {?}
     * @private
     */
    SliderCustomImageComponent.prototype.sanitizer;
    /**
     * @type {?}
     * @private
     */
    SliderCustomImageComponent.prototype.sliderService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2xpZGVyLWN1c3RvbS1pbWFnZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZy1pbWFnZS12aWRlby1nYWxsZXJ5LyIsInNvdXJjZXMiOlsibGliL3NsaWRlci1jdXN0b20taW1hZ2Uvc2xpZGVyLWN1c3RvbS1pbWFnZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQ0gsU0FBUyxFQUNULEtBQUssRUFHTCxNQUFNLEVBQ04sTUFBTSxFQUNOLFlBQVksRUFDZixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDM0MsT0FBTyxFQUFFLFlBQVksRUFBbUIsTUFBTSwyQkFBMkIsQ0FBQztBQUMxRSxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQztBQUNwRSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7O01BRXJELGFBQWEsR0FBRyxzRUFBc0U7O01BQ3hGLG1CQUFtQixHQUFHLENBQUMsTUFBTSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxDQUFDOztNQUNuRCxvQkFBb0IsR0FBRyxDQUFDLEtBQUssQ0FBQzs7TUFDNUIsV0FBVyxHQUFHLHdDQUF3QztBQU01RCxNQUFNLE9BQU8sMEJBQTBCOzs7Ozs7O0lBOEJuQyxZQUNXLGtCQUF3QyxFQUN2QyxTQUF1QixFQUNiLFFBQVEsRUFBVSxhQUE0QjtRQUZ6RCx1QkFBa0IsR0FBbEIsa0JBQWtCLENBQXNCO1FBQ3ZDLGNBQVMsR0FBVCxTQUFTLENBQWM7UUFDSyxrQkFBYSxHQUFiLGFBQWEsQ0FBZTtRQWhDcEUsWUFBTyxHQUFHLFNBQVMsQ0FBQztRQUNwQixVQUFLLEdBQUcsT0FBTyxDQUFDO1FBQ2hCLFVBQUssR0FBRyxPQUFPLENBQUM7UUFDaEIsa0JBQWEsR0FBRyxlQUFlLENBQUM7UUFDaEMsWUFBTyxHQUFvQixFQUFFLENBQUM7UUFD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ICBPbkNoYW5nZXMsXG4gICAgU2ltcGxlQ2hhbmdlcyxcbiAgICBJbmplY3QsXG4gICAgT3V0cHV0LFxuICAgIEV2ZW50RW1pdHRlclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IERPQ1VNRU5UIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7IERvbVNhbml0aXplciwgU2FmZVJlc291cmNlVXJsIH0gZnJvbSAnQGFuZ3VsYXIvcGxhdGZvcm0tYnJvd3Nlcic7XG5pbXBvcnQgeyBOZ0ltYWdlU2xpZGVyU2VydmljZSB9IGZyb20gJy4vLi4vbmctaW1hZ2Utc2xpZGVyLnNlcnZpY2UnO1xuaW1wb3J0IHsgU2xpZGVyU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL3NsaWRlci5zZXJ2aWNlJztcblxuY29uc3QgeW91dHViZVJlZ0V4cCA9IC9eLiooeW91dHUuYmVcXC98dlxcL3x1XFwvXFx3XFwvfGVtYmVkXFwvfHdhdGNoXFw/dj18XFwmdj18XFw/dj0pKFteI1xcJlxcP10qKS4qLyxcbiAgICB2YWxpZEZpbGVFeHRlbnNpb25zID0gWydqcGVnJywgJ2pwZycsICdnaWYnLCAncG5nJ10sXG4gICAgdmFsaWRWaWRlb0V4dGVuc2lvbnMgPSBbJ21wNCddO1xuY29uc3QgdmltZW9SZWdFeHAgPSAvXFwvXFwvKD86d3d3Lik/dmltZW8uY29tXFwvKFswLTlhLXotX10rKS9pO1xuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ2N1c3RvbS1pbWcnLFxuICAgIHRlbXBsYXRlVXJsOiAnLi9zbGlkZXItY3VzdG9tLWltYWdlLmNvbXBvbmVudC5odG1sJ1xufSlcbmV4cG9ydCBjbGFzcyBTbGlkZXJDdXN0b21JbWFnZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uQ2hhbmdlcyB7XG4gICAgWU9VVFVCRSA9ICd5b3V0dWJlJztcbiAgICBJTUFHRSA9ICdpbWFnZSc7XG4gICAgVklERU8gPSAndmlkZW8nO1xuICAgIEFOT1RIRVJfVklERU8gPSAnYW5vdGhlci12aWRlbyc7XG4gICAgZmlsZVVybDogU2FmZVJlc291cmNlVXJsID0gJyc7XG4gICAgdmlkZW9Vcmw6IFNhZmVSZXNvdXJjZVVybCA9ICcnO1xuXG4gICAgZmlsZUV4dGVuc2lvbiA9ICcnO1xuICAgIHR5cGUgPSB0aGlzLklNQUdFO1xuICAgIGltYWdlTG9hZGluZzpib29sZWFuID0gdHJ1ZTtcbiAgICAvLyBAaW5wdXRzXG4gICAgQElucHV0KCkgc2hvd1ZpZGVvOiBib29sZWFuID0gZmFsc2U7XG4gICAgQElucHV0KCkgdmlkZW9BdXRvUGxheTogYm9vbGVhbiA9IGZhbHNlO1xuICAgIEBJbnB1dCgpIHNob3dWaWRlb0NvbnRyb2xzOiBudW1iZXIgPSAxO1xuICAgIEBJbnB1dCgpIGN1cnJlbnRJbWFnZUluZGV4OiBudW1iZXI7XG4gICAgQElucHV0KCkgaW1hZ2VJbmRleDogbnVtYmVyO1xuICAgIEBJbnB1dCgpIHNwZWVkOiBudW1iZXIgPSAxO1xuICAgIEBJbnB1dCgpIGltYWdlVXJsO1xuICAgIEBJbnB1dCgpIGlzVmlkZW8gPSBmYWxzZTtcbiAgICBASW5wdXQoKSBhbHQ6IFN0cmluZyA9ICcnO1xuICAgIEBJbnB1dCgpIHRpdGxlOiBTdHJpbmcgPSAnJztcbiAgICBASW5wdXQoKSBkaXJlY3Rpb246IHN0cmluZyA9ICdsdHInO1xuICAgIEBJbnB1dCgpIHJhdGlvOiBib29sZWFuID0gZmFsc2U7XG4gICAgQElucHV0KCkgbGF6eTogYm9vbGVhbiA9IGZhbHNlO1xuICAgIEBJbnB1dCgpIGltZ0RhdGE7XG4gICAgQElucHV0KCkgaW1nSGVpZ2h0O1xuICAgIEBPdXRwdXQoKSBnZXRUaHVtYm5haWw9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICBASW5wdXQoKSBpbWFnZVBvc2l0aW9uSW5TbGlkZXI7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIGltYWdlU2xpZGVyU2VydmljZTogTmdJbWFnZVNsaWRlclNlcnZpY2UsXG4gICAgICAgIHByaXZhdGUgc2FuaXRpemVyOiBEb21TYW5pdGl6ZXIsXG4gICAgICAgIEBJbmplY3QoRE9DVU1FTlQpIGRvY3VtZW50LCBwcml2YXRlIHNsaWRlclNlcnZpY2U6IFNsaWRlclNlcnZpY2UpIHtcbiAgICB9XG5cbiAgICBuZ09uSW5pdCgpIHtcbiAgICB9XG5cbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XG4gICAgICAgIGlmICh0aGlzLmltYWdlVXJsXG4gICAgICAgICAgICAmJiB0aGlzLmltYWdlVXJsXG4gICAgICAgICAgICAmJiB0aGlzLmltYWdlVXJsXG4gICAgICAgICAgICAmJiB0eXBlb2YgKHRoaXMuaW1hZ2VVcmwpID09PSAnc3RyaW5nJ1xuICAgICAgICAgICAgJiYgKFxuICAgICAgICAgICAgICAgIChjaGFuZ2VzLmltYWdlVXJsICYmIGNoYW5nZXMuaW1hZ2VVcmwuZmlyc3RDaGFuZ2UpXG4gICAgICAgICAgICAgICAgfHxcbiAgICAgICAgICAgICAgICAodGhpcy52aWRlb0F1dG9QbGF5KVxuICAgICAgICAgICAgICAgKSkge1xuICAgICAgICAgICAgdGhpcy5zZXRVcmwoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNldFVybCgpIHtcbiAgICAgICAgY29uc3QgdXJsID0gdGhpcy5pbWFnZVVybDtcbiAgICAgICAgdGhpcy5pbWFnZUxvYWRpbmcgPSB0cnVlO1xuICAgICAgICB0aGlzLmZpbGVVcmwgPSB0aGlzLnNhbml0aXplci5ieXBhc3NTZWN1cml0eVRydXN0UmVzb3VyY2VVcmwodXJsKTtcbiAgICAgICAgdGhpcy5maWxlRXh0ZW5zaW9uID0gdXJsLnNwbGl0KCcuJykucG9wKCkuc3BsaXQoL1xcI3xcXD8vKVswXTtcbiAgICAgICAgaWYgKHRoaXMuaW1hZ2VTbGlkZXJTZXJ2aWNlLmJhc2U2NEZpbGVFeHRlbnNpb24odXJsKVxuICAgICAgICAmJiAodmFsaWRGaWxlRXh0ZW5zaW9ucy5pbmRleE9mKHRoaXMuaW1hZ2VTbGlkZXJTZXJ2aWNlLmJhc2U2NEZpbGVFeHRlbnNpb24odXJsKS50b0xvd2VyQ2FzZSgpKSA+IC0xIFxuICAgICAgICB8fCB2YWxpZFZpZGVvRXh0ZW5zaW9ucy5pbmRleE9mKHRoaXMuaW1hZ2VTbGlkZXJTZXJ2aWNlLmJhc2U2NEZpbGVFeHRlbnNpb24odXJsKS50b0xvd2VyQ2FzZSgpKSA+IC0xKSkge1xuICAgICAgICAgICAgdGhpcy5maWxlRXh0ZW5zaW9uID0gdGhpcy5pbWFnZVNsaWRlclNlcnZpY2UuYmFzZTY0RmlsZUV4dGVuc2lvbih1cmwpO1xuICAgICAgICB9XG4gICAgICAgIC8vIHZlcmlmeSBmb3IgeW91dHViZSB1cmxcbiAgICAgICAgY29uc3QgbWF0Y2ggPSB1cmwubWF0Y2goeW91dHViZVJlZ0V4cCk7XG4gICAgICAgIGNvbnN0IG1hdGNoVmltZW9VcmwgPSB1cmwubWF0Y2godmltZW9SZWdFeHApO1xuICAgICAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMl0ubGVuZ3RoID09PSAxMSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuc2hvd1ZpZGVvKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50eXBlID0gdGhpcy5ZT1VUVUJFO1xuICAgICAgICAgICAgICAgIHRoaXMuZmlsZVVybCA9IHRoaXMuc2FuaXRpemVyLmJ5cGFzc1NlY3VyaXR5VHJ1c3RSZXNvdXJjZVVybChgJHsnaHR0cHM6Ly93d3cueW91dHViZS5jb20vZW1iZWQvJ30ke21hdGNoWzJdfSR7dGhpcy52aWRlb0F1dG9QbGF5ID8gJz9hdXRvcGxheT0xJmVuYWJsZWpzYXBpPTEnIDogJz9hdXRvcGxheT0wJmVuYWJsZWpzYXBpPTEnfSR7JyZjb250cm9scz0nfSR7dGhpcy5zaG93VmlkZW9Db250cm9sc31gKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy50eXBlID0gdGhpcy5JTUFHRTtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbGVVcmwgPSB0aGlzLnNhbml0aXplci5ieXBhc3NTZWN1cml0eVRydXN0UmVzb3VyY2VVcmwoYGh0dHBzOi8vaW1nLnlvdXR1YmUuY29tL3ZpLyR7bWF0Y2hbMl19LzAuanBnYCk7XG4gICAgICAgICAgICAgICAgbGV0IHRodW1uYWlsT2JqZWN0ID0ge2luZGV4OiB0aGlzLmltYWdlUG9zaXRpb25JblNsaWRlciwgaW1hZ2U6IHRoaXMuZmlsZVVybH1cbiAgICAgICAgICAgICAgICB0aGlzLmdldFRodW1ibmFpbC5lbWl0KHRodW1uYWlsT2JqZWN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChtYXRjaFZpbWVvVXJsKSB7ICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLnNsaWRlclNlcnZpY2UuZ2V0b0VtYmVkUmVzcG9uc2UoJ2h0dHBzOi8vdmltZW8uY29tL2FwaS9vZW1iZWQuanNvbj91cmw9JywgdXJsKS5zdWJzY3JpYmUocmVzPT4ge1xuICAgICAgICAgIGlmICh0aGlzLnNob3dWaWRlbykge1xuICAgICAgICAgICAgdGhpcy50eXBlID0gdGhpcy5BTk9USEVSX1ZJREVPO1xuICAgICAgICAgICAgbGV0IHZpbWVvVmlkZW9VcmwgPSBgJHsnaHR0cHM6Ly9wbGF5ZXIudmltZW8uY29tL3ZpZGVvLyd9JHtyZXNbJ3ZpZGVvX2lkJ119YDtcbiAgICAgICAgICAgIHRoaXMudmlkZW9VcmwgPSB0aGlzLnNhbml0aXplci5ieXBhc3NTZWN1cml0eVRydXN0UmVzb3VyY2VVcmwodmltZW9WaWRlb1VybCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnR5cGUgPSB0aGlzLklNQUdFO1xuICAgICAgICAgICAgdGhpcy52aWRlb1VybCA9IHRoaXMuc2FuaXRpemVyLmJ5cGFzc1NlY3VyaXR5VHJ1c3RSZXNvdXJjZVVybChyZXNbJ3RodW1ibmFpbF91cmwnXSk7XG4gICAgICAgICAgICBsZXQgdGh1bW5haWxPYmplY3QgPSB7aW5kZXg6IHRoaXMuaW1hZ2VQb3NpdGlvbkluU2xpZGVyLCBpbWFnZTogdGhpcy52aWRlb1VybH1cbiAgICAgICAgICAgIHRoaXMuZ2V0VGh1bWJuYWlsLmVtaXQodGh1bW5haWxPYmplY3QpO1xuICAgICAgICAgICAgXG5cbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKHVybC5pbmRleE9mKCdodHRwczovL3BsYXllci52aW1lby5jb20vdmlkZW8nKSAhPT0tMSl7XG4gICAgICAgICAgICBpZiAodGhpcy5zaG93VmlkZW8pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSB0aGlzLkFOT1RIRVJfVklERU87XG4gICAgICAgICAgICAgICAgdGhpcy52aWRlb1VybCA9IHRoaXMuc2FuaXRpemVyLmJ5cGFzc1NlY3VyaXR5VHJ1c3RSZXNvdXJjZVVybCh1cmwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSB0aGlzLklNQUdFO1xuICAgICAgICAgICAgICAgIHRoaXMudmlkZW9VcmwgPSB0aGlzLnNhbml0aXplci5ieXBhc3NTZWN1cml0eVRydXN0UmVzb3VyY2VVcmwoJ2RhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBVDRBQUFDZkNBTUFBQUJYMFVYOUFBQUFrRkJNVkVYLy8vOGpJQ0VnSFI0ZEdoc0FBQUFZRkJVVUR4RWJHQm44L1B3UUN3MFdFaFB5OHZJYUZoZjQrUGdmR3h6dDdlMHpNREVuSkNYaDRlSGIyOXVkbkp5OHU3c01CUWpvNk9oVVVsTk9URXdzS1NyTHlzdXVyYTA4T1RwR1EwVFQwdEpuWldhRWc0T2hvS0I1ZDNpenNySndiMitWbEpTTmpJeDdlWHJDd2NGUlQxQmJXbHJPemMxSVJVWTlPenhrWW1PT0ZsWjVBQUFNVWtsRVFWUjRuTzFjNlpxcXNMS1ZZSUF3Q2FLZ2dBTXFEbTJyNy85MkIyU3FZdWg5OXYyMmV2czd0WDVDT2xaV2FrN28wWWhBSUJBSUJBS0JRQ0FRQ0FRQ2dVQWdFQWdFQW9GQUlCQUlCQUtCUUNBUUNBUUNnVUFnRVA3SG9HbWZsdURYUXZQbXh5VFpiVDR0eCs5RWxJYStVQlRmblgxYWtsOElZeTkwSnVWZzQrT25oZmwxOE5aQ3FzREdaTDkvQjIvTnBRWks4bWw1ZmhjbVZ4MndKOGxMNjlNUy9Tck1oSVRvdXhGOWZ3SHJMaVA2ZUVyWjMxL0FjeG1pYjN6NHRFUy9DaEZEOUtsM1VyNi9nUmRDK21UNys5TUMvUzVZYStEN1pIZithWGwrRzJhaVZqL2RJZmIrRnRiWlYyVEdtQ244N2ZUVHd2eEdmQ2ZMTUhTdU0rL1RndnhhYU5Uckl4QUlCTUlnSmxOdk92bTBFUCsvTVQzTVlxOG5sbHBSY2wwN29iTit4QVlhSDg5MmtkRWFyRzJ5U1Y0am56SEo4WWRnUC9FdXUxT1M0UlJ2M3JuZjN0bmhKbmZUVGhKOHVkcGNsVzNHWkpNdkdtYW01OUEwVFhVWm9jSFRQZVBjUGJjRk53SXZpaUt2WnoxV01NM2UvR21sazgwdVNhL0xITnNrRGdaR2FkTmRlbk5Oaytjd1RmdDIvbjVYWmhVN1NsNkdNYkhBS3pGT05tL2FBL3FxZWh1dml2SGNodnpONy9sVEpxNndlMnJNazBWb3Foblg5NlIxSmpJOVBod3p4MzAvM0hVdzV1YzcxL1ZzRDNPWXVoNmUrL1RibXFldXJzdU5zRXpXemE0MnZBTEdmbXlYUHlyMjZNVkRvTmFVWHh4cVdJbW94dk5sWTc4N3Vld2srS2Y2V1hCeWhLS3lZajFDanNIa20xUVhadEg2a2hWbDRMUXpPRHBDeDgxWnBraHhaOXo4UzNEY2hIeU9mRWM3QTU2YVNUN2MycTNTa3NmTUxTZFlndkhqV3NERXIrUm5TbWxneHBFai90bTRYdmdrOFhVRzMreDZKSnVjaE9pUWdxWXBzRm1NMWU2d0RMYmZaZm9mNCtLWTRBZVZSbk5HUjc4dFR0NVg5aHg0eXFhbnhWampEQWFMNHVRM1dyY1hienNsc1ZIaExRQWxySFBhcWNWT0gzbjVZQTRIYXp2VDdCMldqOVJmek4vQlJiWmhyMnAvdTJFZDRaVms5STNZbHRURjA5Rk5Vbmg2cEg3bGsrd2tXV3BERkVvVzI1MVhvbjNhR2FSbTkrOHJPZlpOVkppa1NqL0pUOGpoU3craFk5M0d2emV1M0syVzZoMWh6SFR1WURPUm44NHZ3R2JPd3NuSU92bzlxMUsvOHBsM2N2ZVZmTU5SNjN1dEQ3UEN3am9vQkl1dW1CRDgranJ5dE5tNExhTmZPYlBJN29yUFZtR0xiZmtyb3krNDRwTkxKazIxVXg5NzJicXo0YnRlaDRiVlpPNzJlN01TZW5VNkZkdzY3TFVtRnk4TEgxWXk3Z2dteWhpbzdaWE91OXhGdFI3azlFM3Y3U1hZMzcwVUZTNHVObnRmbVJjZzJVRVpOTnhDeXZKZVRiQnNTU2tMWVp2b21ieCtFWHVUUnljMlpQdGFwaTVlS0lUL2cvMlU0T2xvZzJMSmt5VG4xUFdiNWF2TllTQWU2RUJMWWdVcE9UT0Z3TXBZM2dzeEZwZzlWYm5Ob3FsM1JPN1pmODFSbHJmTWxhYTl6aklXakhiT2ZoYWZuYTRKWWIrbEhLTlE3VXpqdWtPOHUyazNQeXNBNkl1eDMrRFNkcmE3b2owcTZMTlN6SjV5bXhjaDVRU2RpWGpORGJCREhyRjBaNFdqL3RNNzVlUSs2MHZ2MWpJaWs2MlJjeGxIeDl3QmNEZjhvNklXR0RSS1h0TjNRY2tBMHgrYlRCVGpDbmRTUFBPckkxWjdrVllGM1JSS1kxNWZVN3dsWE9icEpraXc1L0pScGJQRCs2c3Y1OFljYUJxVHA5cGUyR3I2ZmVsejlhd254QTY4WVc1bFkwR0kyRE9UWWo5anBGRjVPaGRoSGVmYnBsaE1BYkhNYlhjMi9nMk1xNU5MWVQzUUp2b29VbTFRVE9YbmZIKzNqYjdtNllaMWRXTnJOT21xSCtQT1d1clBhTG03bG5BTXQ1MXkyN1FIMmpGUjVmRno0S2labXhWSDJnM05iUzRBU3pFY3JMNm9DUlFVRW5zb1FnaFVmaUw2K1BiNTdOZzg0M25STWNuRkN6cjBNWDBXR042MWh6L21KNEh4dmNiNStycGMvUTVsQTM2ZElKOEFxM3liUGQyaHdHYzdNUEhad0VrNGpPa3Z3Qm1hcjQ2NkJnZElYMW5nN3B2aGpWdWV0bU1RS3pLUkxxMlM3VDZ6dGdQU01yTTBQUStGRGJOdVNSZ3JvSzMrcFRPeGpvcm1LWno3MWZSOXc3MVNvUkdNb0dPVVY4OFZhazRqZDlNeHdGWXVsZTRwdzdYdEZKbGF2RUgrdlRKU1hPc3dVYXNVdkZPbzVEcS9RejlvWG5FekYvcWpWOU9uUVR0aURtaElCdkFxWDlsVjhzRE8xaVhlS0dwbDRMenNKWXoyN2F5dzBsakxnZlQ1UlIxeE1YczR6YWNIWE10T1Z0OFpTMlQ3SnE0dDNrb2Y4aXVTQUU0a0JpL3NlMUdWZ2hESW5McFFqWEVLYmp1VnY5NjJuRit0SjRpK3F1T3loZXR1cGcrK21sbVlsTk54UVpFSG0weTJ4VkNhbDlNWG9aNVY0MFVNbVBicFpVd0JTWUhhTkpaUE9NUGh0Vk5jdExxZG91SVZHYTk4ZjY3ZlEwbWxVazB5QWRHWThhZDhLRE9XMm4wOTVJNU1mS1R3NzRIOGNtMTJXWXdGbkZSZVhBTXJCSGZxc1pMSjYxb3RWemgwK0RXdkVlVDFHVXZ4RHhicHlWTzhCVkQ0d3FjYUN4V05iSjJBb01URkhqb2UrV2NBd1ZTeTY5WVIxQSttbHQ0Rk9qbS9WbFFMbHllTkJ1TUFrUlUxZFFtQWdubzVFN28xYlQ2S3NkNjkwWGRaRkQ1eWloeW4ydTVLd2ZVdzUrVTMxMk9ZcGR1Vjg0TzV1M0l1MTMyRXJmcmFxK0FicC9hcTN2QUxkbjFLWTJYb2ZyNy9OREJzdTBXTTBlYWdRV3U2NVM5ZXBPRmNOVFAyRzdBbTlVVkZHd0JhZmVYa0xtQjljaFVLTEppSWpHdVdJdVQ2Z0ZFZlc5MmpXaE1zVkZpRno1bm15S0U5RmMwN04wMW5waStyblkxeHBkUUtEdEViV2dZUUZuUWw4dGZ6V2JBQ2xsVDc1Z0NVS0V5cTQ5MEI1UzFtMHlQNndrYmRLTjhFR3FxOGZEN0RYR2ZKU0hBRWh5S3kyUndobzZ5UDJhMnlMRUdaeEtzRDd3Z0hNdlk4dlVYZElIMWJHY0FCT0dWNXFmWDlQZEl4cEUveXVza3ZJbWgrL1B4OGxpSkx0NDlIcCtsWjIvNGQ4SEJFOUlXNDBUK0Y0WXJwcitrWUlNeWg0T29pY3prSjVDbXNyUlFXZVBxNWVxcEJTNFRtRXFGMDBBZVZGWEo5NVlGWUs4a0J4NVN5Nyt4Z0JNRDB0WUlET2lJc0MvWFhBbTJZcENjUlZBUW0xem05QVkyeE9kWFVVR21tTklrV3F1dFoyQmdaSnJ6OGkyVi9OOUJXK0hLSEZTeEdHUTZtejBOUitSMjJPN0pRdWkvSjZLUkdidzUvcDdCUHgrdnV3anhFRlVTekd1U0YrQmFjTDZKTVo1ZytKaXQ4dForM0ROQkMvWGptb05jd2E4bjh4VnR1dXN4dzBZVjA4ZEZJaDVJMVZ2UVFzc1dnL3JCOGE2WkYvU3BZRytCTVJ5bFU1TkZ1TDloUytKVWNnaFlEazkzVlJjS2kwSEZRNGN6OFBWK005WjFMbG15c1FQLzVoRnJUeFcwSjc0b1Bxbm1UdG1nb0Q0YVhBdzV5OTArTWx1K1Q1TzFsMm5iOHhpVnhSS3VPOWdGSEhtcFdxMi82V0hheUhqaUZZTWg1UEZwWjhDbTZKR3FycHlJYUpkTlFYYnNFL2d2bktNdytSdEZ1MWVsdHJWb1pTVEEvTzByM1ZvRzZxUFV6d0djM3lqczhYNzdRODhCcFBicVBNMmtmSFNsQ2RGWUQrTlpRc3pvRk0rMWJQNWROSkxvYmFKdW44czZtTmQzRTV6c2JPRHNWbGZwRitBNkovN1lQM1E4OWg3NGRBWENwT1FEZUJGNUVud0RYajdUSDRMVWVCTWJEMnlOTkY4dTFZeXZtNE1tVDdPUmJwbTNPK0NTUEw5OTJ4OVRyUGRuV3Q4aDNiQVk5SkZpeEJOSVRHSU5nNU1BZGt4K25rMDFWVldXNUpSN0RxaXE3MitSOGRmRWhzdXkrNzU5VWFIMUpsMzdGMjlkcHlWZUN3cndGMGdkRHh4aDBoUDk3K3ZxaGhrdDhVc2RNbmFzdGh0K1M4bFdZZGFuUmw2M3JyUVAwaVFkb3lVUDZVTk5tRE5xV0EvVEovZmRmT3NQRUlqS0dZbDB0aDlKMzVmSmw2SnlWU2NxdDNXaHNmNGRmeURrK3crSU0wUWY3bG1Qd3ZKOCtzWXdIcjNjQThuem5vT1gxNEk5RDVmZXkxejNVRVYrZE5tMG44a3I1dlp4ZDNzZXEveGpSTndGckhFTmI2cms5eVB6VUdzMjZsNzVhUHlmdWNYV1Q1UWYrK05zLzA4WmhsU25ibmxiRnVYMXRqU2xGRDI3VHRPVTRQRnNBdFQzMGZhTlptejZtaDdtNldFbC9CbEFPNHNwWC9YMkpsZ3plSzJWaThmNS9iWFNFaDdvczZjdlhOL2oySWRPZFU3bWFRMTBtbzFSVmErN093bjdMYUxyQ2VteksyMkxCMW5uSUtKbkt3eTJzZnJXVDJ1di9HSmRPSC9nS3lxcnYyREw5UGxBcmdnL3hKWm03YVdPb2wyVVorZ1J5T2xiaThtS1JPa29oZDBCMU1tSVc4NnB3MEdZaGI5MWhMWWE0aTJQN3RzcGgxVTJqR2JlM24vbnZGTUVpLzhLRHljSk9CaytuanI0aTI4eVdUZUd2OEJjcVJyeHd4MExSL1FmK2kwMnk0cjVRdUZnamxUZ3FJdjljeVRZVlAzeGNZRmZBTzRlK0xoY3BKc3MvYUZKOGZmWFk5WDB6TmprNlBtL1NKaWJyNC9DSGoyeGVET3ZvbUhxNFBQNzBPYzRtdWExV3E5dDJGbld0Tzdqc1R2dHQ1NzhLYVp2NTdMUlBIMWg1dk5NeW0yaDlQVjA2ZXhVY3pqZkg1WXJDM1hDMTNKN21tOEhLZnpKUDc2NFk1L0JsWjVsY1B2cnhvckg1bnY2eFEyWVkvNmdCbmswMDlHTmE0SDFuOERvdGx5NHNMNXJudUd6YXJTMENnVUFnRUFnRUFvRkFJQkFJQkFLQlFDQVFDQVFDZ1VBZ0VBZ0VBb0ZBSUJBSUJBS0JRQ0FRQ0FRQ2dVQWdFQWdFQW9GQUlCQUlCQUtCUVBnLzREOTJIY1BQaE5MMkpBQUFBQUJKUlU1RXJrSmdnZz09Jyk7XG4gICAgICAgICAgICAgICAgbGV0IHRodW1uYWlsT2JqZWN0ID0ge2luZGV4OiB0aGlzLmltYWdlUG9zaXRpb25JblNsaWRlciwgaW1hZ2U6IHRoaXMudmlkZW9Vcmx9XG4gICAgICAgICAgICAgICAgdGhpcy5nZXRUaHVtYm5haWwuZW1pdCh0aHVtbmFpbE9iamVjdCk7ICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYodXJsLmluZGV4T2YoJ2h0dHBzOi8vcGxheWVycy5icmlnaHRjb3ZlLm5ldC8nKSAhPT0tMSl7XG4gICAgICAgICAgICBpZiAodGhpcy5zaG93VmlkZW8pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSB0aGlzLkFOT1RIRVJfVklERU87XG4gICAgICAgICAgICAgICAgdGhpcy52aWRlb1VybCA9IHRoaXMuc2FuaXRpemVyLmJ5cGFzc1NlY3VyaXR5VHJ1c3RSZXNvdXJjZVVybCh1cmwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSB0aGlzLklNQUdFO1xuICAgICAgICAgICAgICAgIHRoaXMudmlkZW9VcmwgPSB0aGlzLnNhbml0aXplci5ieXBhc3NTZWN1cml0eVRydXN0UmVzb3VyY2VVcmwoJ2h0dHBzOi8vY2RuLm1vcy5jbXMuZnV0dXJlY2RuLm5ldC94bmhCR3J6d0FIbWJUbXlmV3g2UnNNLTk3MC03NS5wbmcud2VicCcpO1xuICAgICAgICAgICAgICAgIGxldCB0aHVtbmFpbE9iamVjdCA9IHtpbmRleDogdGhpcy5pbWFnZVBvc2l0aW9uSW5TbGlkZXIsIGltYWdlOiB0aGlzLnZpZGVvVXJsfVxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0VGh1bWJuYWlsLmVtaXQodGh1bW5haWxPYmplY3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuZmlsZUV4dGVuc2lvbiAmJiB2YWxpZEZpbGVFeHRlbnNpb25zLmluZGV4T2YodGhpcy5maWxlRXh0ZW5zaW9uLnRvTG93ZXJDYXNlKCkpID4gLTEpIHtcbiAgICAgICAgICAgIHRoaXMudHlwZSA9IHRoaXMuSU1BR0U7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5maWxlRXh0ZW5zaW9uICYmIHZhbGlkVmlkZW9FeHRlbnNpb25zLmluZGV4T2YodGhpcy5maWxlRXh0ZW5zaW9uLnRvTG93ZXJDYXNlKCkpID4gLTEpIHtcbiAgICAgICAgICAgIHRoaXMudHlwZSA9IHRoaXMuVklERU87XG4gICAgICAgICAgICBpZiAodGhpcy52aWRlb0F1dG9QbGF5ICYmIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGB2aWRlb18ke3RoaXMuaW1hZ2VJbmRleH1gKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHZpZGVvT2JqOmFueSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGB2aWRlb18ke3RoaXMuaW1hZ2VJbmRleH1gKTtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdmlkZW9PYmoucGxheSgpO1xuICAgICAgICAgICAgICAgIH0sIHRoaXMuc3BlZWQgKiAxMDAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHZpZGVvQ2xpY2tIYW5kbGVyKGV2ZW50KSB7XG4gICAgICAgIGlmIChldmVudCAmJiBldmVudC5zcmNFbGVtZW50ICYmICF0aGlzLnNob3dWaWRlb0NvbnRyb2xzKSB7XG4gICAgICAgICAgICBpZiAoZXZlbnQuc3JjRWxlbWVudC5wYXVzZWQpIHtcbiAgICAgICAgICAgICAgICBldmVudC5zcmNFbGVtZW50LnBsYXkoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZXZlbnQuc3JjRWxlbWVudC5wYXVzZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuIl19